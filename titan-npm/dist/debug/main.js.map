{"version":3,"sources":["../../scripts/entities/titan.ts","../../scripts/utils/string_utils.ts","../../scripts/fx/particle_fx.ts"],"sourcesContent":["// scripts/entities/titan.ts\r\nimport { world, system, EntityTypes } from '@minecraft/server';\r\nimport { addNamespace } from '../utils/string_utils';\r\nimport { createImpactDust } from '../fx/particle_fx';\r\n\r\n// 实体标识符\r\nconst TITAN_ID = addNamespace('earth_titan');\r\n\r\nworld.afterEvents.entitySpawn.subscribe(event => {\r\n  const entity = event.entity;\r\n  \r\n  if (entity.typeId !== TITAN_ID) {\r\n    return;\r\n  }\r\n  //world.getDimension(\"overworld\").runCommand(`say Titan entity spawned at: ${entity.location.x}, ${entity.location.y}, ${entity.location.z}`);\r\n  //console.log(`Titan entity spawned at: ${entity.location.x}, ${entity.location.y}, ${entity.location.z}`);\r\n  world.getPlayers().forEach(player => {\r\n    player.sendMessage(`Titan entity spawned at: ${entity.location.x}, ${entity.location.y}, ${entity.location.z}`);\r\n  });\r\n});\r\n\r\n// 使用实体命中事件\r\nworld.afterEvents.entityHitEntity.subscribe(event => {\r\n  // 检查是否是 Titan 攻击其他实体\r\n  if (event.damagingEntity && event.damagingEntity.typeId === TITAN_ID && \r\n      event.hitEntity.typeId !== TITAN_ID) {\r\n    const attacker = event.damagingEntity;\r\n    const target = event.hitEntity;\r\n    console.log(`Titan hit entity: ${target.typeId}`);\r\n    \r\n    // 计算命中位置\r\n    const hitLocation = {\r\n      // 在两个实体之间计算接触点，略微偏向目标\r\n      x: target.location.x + (attacker.location.x - target.location.x) * 0.3,\r\n      y: target.location.y + (target.getHeadLocation().y - target.location.y) * 1.6, // 大约在胸部位置\r\n      z: target.location.z + (attacker.location.z - target.location.z) * 0.3\r\n    };\r\n    \r\n    // 生成撞击尘埃效果   \r\n    createImpactDust(target.dimension, hitLocation);\r\n  }\r\n});\r\n\r\nconsole.log(\"Titan entity script loaded\");","// scripts/utils/string_utils.ts\r\nexport function addNamespace(name: string): string {\r\n    return `titan:${name}`;\r\n  }","import { Dimension, Vector3 } from '@minecraft/server';\r\n\r\n//在指定位置生成粒子效果\r\n\r\nexport function spawnParticleEffect(dimension: Dimension, particleName: string, location: Vector3) {\r\n  try {\r\n    dimension.spawnParticle(particleName, location);\r\n  } catch (e) {\r\n    console.warn(`Failed to spawn particle ${particleName}: ${e}`);\r\n  }\r\n}\r\n\r\n//创建撞击尘埃效果\r\n\r\nexport function createImpactDust(dimension: Dimension, location: Vector3) {\r\n  spawnParticleEffect(dimension, 'titan:impact_dust', location);\r\n}"],"mappings":";AACA,SAAS,aAAkC;;;ACApC,SAAS,aAAa,MAAsB;AAC/C,SAAO,SAAS,IAAI;AACtB;;;ACCK,SAAS,oBAAoB,WAAsB,cAAsB,UAAmB;AACjG,MAAI;AACF,cAAU,cAAc,cAAc,QAAQ;AAAA,EAChD,SAAS,GAAG;AACV,YAAQ,KAAK,4BAA4B,YAAY,KAAK,CAAC,EAAE;AAAA,EAC/D;AACF;AAIO,SAAS,iBAAiB,WAAsB,UAAmB;AACxE,sBAAoB,WAAW,qBAAqB,QAAQ;AAC9D;;;AFVA,IAAM,WAAW,aAAa,aAAa;AAE3C,MAAM,YAAY,YAAY,UAAU,WAAS;AAC/C,QAAM,SAAS,MAAM;AAErB,MAAI,OAAO,WAAW,UAAU;AAC9B;AAAA,EACF;AAGA,QAAM,WAAW,EAAE,QAAQ,YAAU;AACnC,WAAO,YAAY,4BAA4B,OAAO,SAAS,CAAC,KAAK,OAAO,SAAS,CAAC,KAAK,OAAO,SAAS,CAAC,EAAE;AAAA,EAChH,CAAC;AACH,CAAC;AAGD,MAAM,YAAY,gBAAgB,UAAU,WAAS;AAEnD,MAAI,MAAM,kBAAkB,MAAM,eAAe,WAAW,YACxD,MAAM,UAAU,WAAW,UAAU;AACvC,UAAM,WAAW,MAAM;AACvB,UAAM,SAAS,MAAM;AACrB,YAAQ,IAAI,qBAAqB,OAAO,MAAM,EAAE;AAGhD,UAAM,cAAc;AAAA;AAAA,MAElB,GAAG,OAAO,SAAS,KAAK,SAAS,SAAS,IAAI,OAAO,SAAS,KAAK;AAAA,MACnE,GAAG,OAAO,SAAS,KAAK,OAAO,gBAAgB,EAAE,IAAI,OAAO,SAAS,KAAK;AAAA;AAAA,MAC1E,GAAG,OAAO,SAAS,KAAK,SAAS,SAAS,IAAI,OAAO,SAAS,KAAK;AAAA,IACrE;AAGA,qBAAiB,OAAO,WAAW,WAAW;AAAA,EAChD;AACF,CAAC;AAED,QAAQ,IAAI,4BAA4B;","names":[],"file":"../scripts/main.js"}